!function(t){var e=function(t){return t.split("").reverse().join("")},i={numberStep:function(e,i){var n=Math.floor(e);t(i.elem).text(n)}},n=function(t){var e=t.elem;e.nodeType&&e.parentNode&&(e=e._animateNumberSetter,e||(e=i.numberStep),e(t.now,t))};t.Tween&&t.Tween.propHooks?t.Tween.propHooks.number={set:n}:t.fx.step.number=n,t.animateNumber={numberStepFactories:{append:function(e){return function(i,n){var s=Math.floor(i);t(n.elem).prop("number",i).text(s+e)}},separator:function(i,n,s){return i=i||" ",n=n||3,s=s||"",function(r,o){var a=0>r,l=Math.floor((a?-1:1)*r).toString(),h=t(o.elem);if(l.length>n){for(var c,u,p,d=l,g=n,f=d.split("").reverse(),l=[],m=0,v=Math.ceil(d.length/g);m<v;m++){for(c="",p=0;p<g&&(u=m*g+p,u!==d.length);p++)c+=f[u];l.push(c)}d=l.length-1,g=e(l[d]),l[d]=e(parseInt(g,10).toString()),l=l.join(i),l=e(l)}h.prop("number",r).text((a?"-":"")+l+s)}}}},t.fn.animateNumber=function(){for(var e=arguments[0],n=t.extend({},i,e),s=t(this),r=[n],o=1,a=arguments.length;o<a;o++)r.push(arguments[o]);if(e.numberStep){var l=this.each(function(){this._animateNumberSetter=e.numberStep}),h=n.complete;n.complete=function(){l.each(function(){delete this._animateNumberSetter}),h&&h.apply(this,arguments)}}return s.animate.apply(s,r)}}(jQuery),function(t){var e={tooltip:!1,tooltipOpts:{content:"%s | X: %x | Y: %y",xDateFormat:null,yDateFormat:null,monthNames:null,dayNames:null,shifts:{x:10,y:20},defaultTheme:!0,onHover:function(t,e){}}},i=function(t){this.tipPosition={x:0,y:0},this.init(t)};i.prototype.init=function(e){function i(t){var e={};e.x=t.pageX,e.y=t.pageY,s.updateTooltipPosition(e)}function n(t,e,i){var n=s.getDomElement();if(i){var r;r=s.stringFormat(s.tooltipOptions.content,i),n.html(r),s.updateTooltipPosition({x:e.pageX,y:e.pageY}),n.css({left:s.tipPosition.x+s.tooltipOptions.shifts.x,top:s.tipPosition.y+s.tooltipOptions.shifts.y}).show(),"function"==typeof s.tooltipOptions.onHover&&s.tooltipOptions.onHover(i,n)}else n.hide().html("")}var s=this,r=t.plot.plugins.length;if(this.plotPlugins=[],r)for(var o=0;o<r;o++)this.plotPlugins.push(t.plot.plugins[o].name);e.hooks.bindEvents.push(function(e,r){if(s.plotOptions=e.getOptions(),s.plotOptions.tooltip!==!1&&"undefined"!=typeof s.plotOptions.tooltip){s.tooltipOptions=s.plotOptions.tooltipOpts;s.getDomElement();t(e.getPlaceholder()).bind("plothover",n),t(r).bind("mousemove",i)}}),e.hooks.shutdown.push(function(e,s){t(e.getPlaceholder()).unbind("plothover",n),t(s).unbind("mousemove",i)})},i.prototype.getDomElement=function(){var e;return t("#flotTip").length>0?e=t("#flotTip"):(e=t("<div />").attr("id","flotTip"),e.appendTo("body").hide().css({position:"absolute"}),this.tooltipOptions.defaultTheme&&e.css({background:"#fff","z-index":"1040",padding:"0.4em 0.6em","border-radius":"0.5em","font-size":"0.8em",border:"1px solid #111",display:"none","white-space":"nowrap"})),e},i.prototype.updateTooltipPosition=function(e){var i=t("#flotTip").outerWidth()+this.tooltipOptions.shifts.x,n=t("#flotTip").outerHeight()+this.tooltipOptions.shifts.y;e.x-t(window).scrollLeft()>t(window).innerWidth()-i&&(e.x-=i),e.y-t(window).scrollTop()>t(window).innerHeight()-n&&(e.y-=n),this.tipPosition.x=e.x,this.tipPosition.y=e.y},i.prototype.stringFormat=function(t,e){var i,n,s=/%p\.{0,1}(\d{0,})/,r=/%s/,o=/%lx/,a=/%ly/,l=/%x\.{0,1}(\d{0,})/,h=/%y\.{0,1}(\d{0,})/,c="%x",u="%y";if("undefined"!=typeof e.series.threshold?(i=e.datapoint[0],n=e.datapoint[1]):(i=e.series.data[e.dataIndex][0],n=e.series.data[e.dataIndex][1]),null===e.series.label&&e.series.originSeries&&(e.series.label=e.series.originSeries.label),"function"==typeof t&&(t=t(e.series.label,i,n,e)),"undefined"!=typeof e.series.percent&&(t=this.adjustValPrecision(s,t,e.series.percent)),t="undefined"!=typeof e.series.label?t.replace(r,e.series.label):t.replace(r,""),t=this.hasAxisLabel("xaxis",e)?t.replace(o,e.series.xaxis.options.axisLabel):t.replace(o,""),t=this.hasAxisLabel("yaxis",e)?t.replace(a,e.series.yaxis.options.axisLabel):t.replace(a,""),this.isTimeMode("xaxis",e)&&this.isXDateFormat(e)&&(t=t.replace(l,this.timestampToDate(i,this.tooltipOptions.xDateFormat))),this.isTimeMode("yaxis",e)&&this.isYDateFormat(e)&&(t=t.replace(h,this.timestampToDate(n,this.tooltipOptions.yDateFormat))),"number"==typeof i&&(t=this.adjustValPrecision(l,t,i)),"number"==typeof n&&(t=this.adjustValPrecision(h,t,n)),"undefined"!=typeof e.series.xaxis.ticks){var p;p=this.hasRotatedXAxisTicks(e)?"rotatedTicks":"ticks";var d=e.dataIndex+e.seriesIndex;e.series.xaxis[p].length>d&&!this.isTimeMode("xaxis",e)&&(t=t.replace(l,e.series.xaxis[p][d].label))}if("undefined"!=typeof e.series.yaxis.ticks)for(var g in e.series.yaxis.ticks)if(e.series.yaxis.ticks.hasOwnProperty(g)){var f=this.isCategoriesMode("yaxis",e)?e.series.yaxis.ticks[g].label:e.series.yaxis.ticks[g].v;f===n&&(t=t.replace(h,e.series.yaxis.ticks[g].label))}return"undefined"!=typeof e.series.xaxis.tickFormatter&&(t=t.replace(c,e.series.xaxis.tickFormatter(i,e.series.xaxis).replace(/\$/g,"$$"))),"undefined"!=typeof e.series.yaxis.tickFormatter&&(t=t.replace(u,e.series.yaxis.tickFormatter(n,e.series.yaxis).replace(/\$/g,"$$"))),t},i.prototype.isTimeMode=function(t,e){return"undefined"!=typeof e.series[t].options.mode&&"time"===e.series[t].options.mode},i.prototype.isXDateFormat=function(t){return"undefined"!=typeof this.tooltipOptions.xDateFormat&&null!==this.tooltipOptions.xDateFormat},i.prototype.isYDateFormat=function(t){return"undefined"!=typeof this.tooltipOptions.yDateFormat&&null!==this.tooltipOptions.yDateFormat},i.prototype.isCategoriesMode=function(t,e){return"undefined"!=typeof e.series[t].options.mode&&"categories"===e.series[t].options.mode},i.prototype.timestampToDate=function(e,i){var n=new Date(1*e);return t.plot.formatDate(n,i,this.tooltipOptions.monthNames,this.tooltipOptions.dayNames)},i.prototype.adjustValPrecision=function(t,e,i){var n,s=e.match(t);return null!==s&&""!==RegExp.$1&&(n=RegExp.$1,i=i.toFixed(n),e=e.replace(t,i)),e},i.prototype.hasAxisLabel=function(t,e){return this.plotPlugins.indexOf("axisLabels")!==-1&&"undefined"!=typeof e.series[t].options.axisLabel&&e.series[t].options.axisLabel.length>0},i.prototype.hasRotatedXAxisTicks=function(e){return 1===t.grep(t.plot.plugins,function(t){return"tickRotor"===t.name}).length&&"undefined"!==e.series.xaxis.rotatedTicks};var n=function(t){new i(t)};t.plot.plugins.push({init:n,options:e,name:"tooltip",version:"0.6.7"})}(jQuery),function(t){"use strict";function e(t,e,i,n,s,r,o){var a,l,h,c,u,p,d,g,f=Math.pow,m=Math.sqrt;return a=m(f(i-t,2)+f(n-e,2)),l=m(f(s-i,2)+f(r-n,2)),h=o*a/(a+l),c=o-h,u=i+h*(t-s),p=n+h*(e-r),d=i-c*(t-s),g=n-c*(e-r),[u,p,d,g]}function i(e,i,n,s,r){var o=t.color.parse(r);o.a="number"==typeof s?s:.3,o.normalize(),o=o.toString(),i.beginPath(),i.moveTo(e[0][0],e[0][1]);for(var a=e.length,l=0;l<a;l++)i[e[l][3]].apply(i,e[l][2]);i.stroke(),i.lineWidth=0,i.lineTo(e[a-1][0],n),i.lineTo(e[0][0],n),i.closePath(),s!==!1&&(i.fillStyle=o,i.fill())}function n(t,e,i,n){(void 0===e||"bezier"!==e&&"quadratic"!==e)&&(e="quadratic"),e+="CurveTo",0==r.length?r.push([i[0],i[1],n.concat(i.slice(2)),e]):"quadraticCurveTo"==e&&2==i.length?(n=n.slice(0,2).concat(i),r.push([i[0],i[1],n,e])):r.push([i[2],i[3],n.concat(i.slice(2)),e])}function s(s,o,a){if(a.splines.show===!0){var l,h,c,u=[],p=a.splines.tension||.5,d=a.datapoints.points,g=a.datapoints.pointsize,f=s.getPlotOffset(),m=d.length,v=[];if(r=[],m/g<4)return void t.extend(a.lines,a.splines);for(l=0;l<m;l+=g)h=d[l],c=d[l+1],null==h||h<a.xaxis.min||h>a.xaxis.max||c<a.yaxis.min||c>a.yaxis.max||v.push(a.xaxis.p2c(h)+f.left,a.yaxis.p2c(c)+f.top);for(m=v.length,l=0;l<m-2;l+=2)u=u.concat(e.apply(this,v.slice(l,l+6).concat([p])));for(o.save(),o.strokeStyle=a.color,o.lineWidth=a.splines.lineWidth,n(o,"quadratic",v.slice(0,4),u.slice(0,2)),l=2;l<m-3;l+=2)n(o,"bezier",v.slice(l,l+4),u.slice(2*l-2,2*l+2));n(o,"quadratic",v.slice(m-2,m),[u[2*m-10],u[2*m-9],v[m-4],v[m-3]]),i(r,o,s.height()+10,a.splines.fill,a.color),o.restore()}}var r=[];t.plot.plugins.push({init:function(t){t.hooks.drawSeries.push(s)},options:{series:{splines:{show:!1,lineWidth:2,tension:.5,fill:!1}}},name:"spline",version:"0.8.2"})}(jQuery),function(t,e){angular.module("iso.config",[]).value("iso.config",{debug:!0}),angular.module("iso.directives",["iso.services"]),angular.module("iso.services",[]),angular.module("iso",["iso.config","iso.directives","iso.services"]),angular.module("iso.controllers",["iso.config","iso.services"]).controller("angularIsotopeController",["iso.config","iso.topics","$scope","$timeout","optionsStore",function(t,e,i,n,s){"use strict";var r,o,a,l,h,c,u,p,d;c="isotope.onLayout",p=!1,l=null,r=[],d="",a="",i.$on(c,function(t){}),i.layoutEventEmit=function(t,e){return n(function(){return i.$apply(function(){return i.$emit(c)})})},s.store({onLayout:i.layoutEventEmit}),o=function(t,e,n){if(e)return t.call(i,e,n)},i.delayInit=function(t){s.storeInit(t)},i.delayedInit=function(){var t=s.retrieveInit();i.init(t)},i.$on("iso-init",function(){i.delayedInit()}),i.init=function(t){return s.storeInit(t),l=t.element,o(i.$on,t.isoOptionsEvent||e.MSG_OPTIONS,u),o(i.$on,t.isoMethodEvent||e.MSG_METHOD,h),i.isoMode=t.isoMode||"addItems",n(function(){var t=s.retrieve();l.isotope(t),p=!0})},i.setIsoElement=function(t){if(p)return n(function(){return l.isotope(i.isoMode,t)})},i.refreshIso=function(){if(p)return l.isotope()},i.updateOptions=function(t){l?l.isotope(t):s.store(t)},i.updateMethod=function(t,e,i){return l.isotope(t,e,i)},u=function(t,e){return i.updateOptions(e)},h=function(t,e){var n,s;return n=e.name,s=e.params,i.updateMethod(n,s,null)},i.removeAll=function(t){return l.isotope("remove",l.data("isotope").$allAtoms,t)},i.refresh=function(){return l.isotope()},i.$on(t.refreshEvent,function(){return i.refreshIso()}),i.$on(e.MSG_REMOVE,function(t,e){return i.removeElement(e)}),i.$on(e.MSG_OPTIONS,function(t,e){return u(t,e)}),i.$on(e.MSG_METHOD,function(t,e){return h(t,e)}),i.removeElement=function(t){return l&&l.isotope("remove",t)}}]).controller("isoSortByDataController",["iso.config","$scope","optionsStore",function(t,e,i){var n,s;e.getHash=function(t){return"opt"+t},e.storeMethods=function(t){return i.store({getSortData:t})},e.optSortData=function(t,i){var s,r,o,a,l,h,c;return r={},s=$(t),l=s.attr("ok-sel"),c=s.attr("ok-type"),h=e.getHash(l),o=s.attr("opt-convert")?eval_("["+s.attr("opt-convert")+"]")[0]:null,a=function(t,e,i){return function(s){return n(t,s,e,i)}},r[h]=a(l,c,o),r},e.createSortByDataMethods=function(t){var i,n;return i=$(t),n=s($.map(i,e.optSortData))},s=function(t){var e;return e={},$.each(t,function(t,i){return $.extend(e,i)}),e},n=function(t,e,i,n){var s,r,o,a,l;return s=function(t,e,i){var n;if(!e.length)return t.text();switch(n="",i.charAt(0)){case"#":n=e.text();break;case".":n=e.text();break;case"[":n=e.attr(i.replace("[","").replace("]","").split()[0])}return n},a=function(t,e){var i,n;return i=function(t){return isNaN(t)?Number.POSITIVE_INFINITY:t},n={text:function(t){return t.toString()},integer:function(t){return i(parseInt(t,10))},"float":function(t){return i(parseFloat(t))},"boolean":function(t){return"true"===t}},n[e]?n[e](t):t},r=e.find(t),o=s(e,r,t),l=a(o,i),n?n(l):l}}]),angular.module("iso.directives",["iso.config","iso.services","iso.controllers"]),angular.module("iso.directives").directive("isotopeContainer",["$injector","$parse",function(t,e){"use strict";var i;return i={},{controller:"angularIsotopeController",link:function(t,i,n){var s,r,o;return o=[],r=n.isoOptions,s={},r&&(o=e(r)(t),angular.isObject(o)&&t.updateOptions(o)),s.element=i,s.isoOptionsEvent=n.isoOptionsSubscribe,s.isoMethodEvent=n.isoMethodSubscribe,s.isoMode=n.isoMode,"true"===n.isoUseInitEvent?t.delayInit(s):t.init(s),i}}}]).directive("isotopeItem",["$rootScope","iso.config","iso.topics","$timeout",function(t,e,i,n){return{restrict:"A",require:"^isotopeContainer",link:function(s,r,o){return s.setIsoElement(r),s.$on("$destroy",function(e){t.$broadcast(i.MSG_REMOVE,r)}),o.ngRepeat&&!0===s.$last&&"addItems"===s.isoMode&&r.ready(function(){return n(function(){return s.refreshIso()},e.refreshDelay||0)}),o.ngRepeat||r.ready(function(){return n(function(){return s.refreshIso()},e.refreshDelay||0)}),r}}}]).directive("isoSortbyData",function(){return{restrict:"A",controller:"isoSortByDataController",link:function(t,e,i){var n,s,r,o,a,l;return a=$(e),o=a.attr("ok-key"),r="iso-opts",l={},n=a.find("[ok-sel]"),n.each(function(e){var i;return i=$(this),i.attr("ok-sortby-key",t.getHash(i.attr("ok-sel")))}),s=t.createSortByDataMethods(n),t.storeMethods(s)}}}).directive("optKind",["optionsStore","iso.topics",function(t,e){return{restrict:"A",controller:"isoSortByDataController",link:function(i,n,s){var r,o,a,l,h,c,u,p,d,g,f;if(p=$(n),c=s.okPublish||s.okOptionsPublish||e.MSG_OPTIONS,u=s.okMethodPublish||e.MSG_METHOD,h=p.attr("ok-key"),determineActiveClass=function(){d=s.okActiveClass,d||(d=p.find(".selected").length?"selected":"active"),g="."+d,f=p.find(g)},r=function(t){var e,n,s,r;if(s=t.attr("ok-key"),"sortBy"===s)return r={},e=t.find("[ok-sel]"),e.each(function(t){var e;return e=$(this),e.attr("ok-sortby-key",i.getHash(e.attr("ok-sel")))}),n=i.createSortByDataMethods(e),i.storeMethods(n)},o=function(t){var e,i,n,s;if(t)return n={},s=t.attr("ok-sortby-key"),e=t.attr("opt-ascending"),i=s||t.attr("ok-sel"),s&&(n.sortAscending=!e||"true"===e),n[h]=i,n},l=function(e){return t.store(e),i.$emit(c,e)},a=function(t){var e;return t.preventDefault(),e=$(t.target),!e.hasClass(d)&&(p.find(g).removeClass(d),e.addClass(d),l(o(e)),!1)},determineActiveClass(),r(p),f.length){var m=o(f);t.store(m)}return p.on("click",function(t){return a(t)})}}}]),angular.module("iso.services",["iso.config"],["$provide",function(t){return t.factory("optionsStore",["iso.config",function(t){"use strict";var e,i;return e=t.defaultOptions||{},{store:function(t){return e=$.extend.apply(null,[!0,e].concat(t))},retrieve:function(){return e},storeInit:function(t){i=t},retrieveInit:function(){return i}}}])}]).value("iso.topics",{MSG_OPTIONS:"iso-option",MSG_METHOD:"iso-method",MSG_REMOVE:"iso-remove"})}(window,document),!function(t){"use strict";var e=function(e,i){this.options=i,this.$element=t(e),this.$container=t("<div/>",{"class":"ms-container"}),this.$selectableContainer=t("<div/>",{"class":"ms-selectable"}),this.$selectionContainer=t("<div/>",{"class":"ms-selection"}),this.$selectableUl=t("<ul/>",{"class":"ms-list",tabindex:"-1"}),this.$selectionUl=t("<ul/>",{"class":"ms-list",tabindex:"-1"}),this.scrollTo=0,this.elemsSelector="li:visible:not(.ms-optgroup-label,.ms-optgroup-container,."+i.disabledClass+")"};e.prototype={constructor:e,init:function(){var e=this,i=this.$element;if(0===i.next(".ms-container").length){i.css({position:"absolute",left:"-9999px"}),i.attr("id",i.attr("id")?i.attr("id"):Math.ceil(1e3*Math.random())+"multiselect"),this.$container.attr("id","ms-"+i.attr("id")),this.$container.addClass(e.options.cssClass),i.find("option").each(function(){e.generateLisFromOption(this)}),this.$selectionUl.find(".ms-optgroup-label").hide(),e.options.selectableHeader&&e.$selectableContainer.append(e.options.selectableHeader),e.$selectableContainer.append(e.$selectableUl),e.options.selectableFooter&&e.$selectableContainer.append(e.options.selectableFooter),e.options.selectionHeader&&e.$selectionContainer.append(e.options.selectionHeader),e.$selectionContainer.append(e.$selectionUl),e.options.selectionFooter&&e.$selectionContainer.append(e.options.selectionFooter),e.$container.append(e.$selectableContainer),e.$container.append(e.$selectionContainer),i.after(e.$container),e.activeMouse(e.$selectableUl),e.activeKeyboard(e.$selectableUl);var n=e.options.dblClick?"dblclick":"click";e.$selectableUl.on(n,".ms-elem-selectable",function(){e.select(t(this).data("ms-value"))}),e.$selectionUl.on(n,".ms-elem-selection",function(){e.deselect(t(this).data("ms-value"))}),e.activeMouse(e.$selectionUl),e.activeKeyboard(e.$selectionUl),i.on("focus",function(){e.$selectableUl.focus()})}var s=i.find("option:selected").map(function(){return t(this).val()}).get();e.select(s,"init"),"function"==typeof e.options.afterInit&&e.options.afterInit.call(this,this.$container)},generateLisFromOption:function(e,i,n){for(var s=this,r=s.$element,o="",a=t(e),l=0;l<e.attributes.length;l++){var h=e.attributes[l];"value"!==h.name&&"disabled"!==h.name&&(o+=h.name+'="'+h.value+'" ')}var c=t("<li "+o+"><span>"+s.escapeHTML(a.text())+"</span></li>"),u=c.clone(),p=a.val(),d=s.sanitize(p);c.data("ms-value",p).addClass("ms-elem-selectable").attr("id",d+"-selectable"),u.data("ms-value",p).addClass("ms-elem-selection").attr("id",d+"-selection").hide(),(a.prop("disabled")||r.prop("disabled"))&&(u.addClass(s.options.disabledClass),c.addClass(s.options.disabledClass));var g=a.parent("optgroup");if(g.length>0){var f=g.attr("label"),m=s.sanitize(f),v=s.$selectableUl.find("#optgroup-selectable-"+m),y=s.$selectionUl.find("#optgroup-selection-"+m);if(0===v.length){var x='<li class="ms-optgroup-container"></li>',b='<ul class="ms-optgroup"><li class="ms-optgroup-label"><span>'+f+"</span></li></ul>";v=t(x),y=t(x),v.attr("id","optgroup-selectable-"+m),y.attr("id","optgroup-selection-"+m),v.append(t(b)),y.append(t(b)),s.options.selectableOptgroup&&(v.find(".ms-optgroup-label").on("click",function(){var e=g.children(":not(:selected, :disabled)").map(function(){return t(this).val()}).get();s.select(e)}),y.find(".ms-optgroup-label").on("click",function(){var e=g.children(":selected:not(:disabled)").map(function(){return t(this).val()}).get();s.deselect(e)})),s.$selectableUl.append(v),s.$selectionUl.append(y)}i=void 0==i?v.find("ul").children().length:i+1,c.insertAt(i,v.children()),u.insertAt(i,y.children())}else i=void 0==i?s.$selectableUl.children().length:i,c.insertAt(i,s.$selectableUl),u.insertAt(i,s.$selectionUl)},addOption:function(e){var i=this;e.value&&(e=[e]),t.each(e,function(e,n){if(n.value&&0===i.$element.find("option[value='"+n.value+"']").length){var s=t('<option value="'+n.value+'">'+n.text+"</option>"),e=parseInt("undefined"==typeof n.index?i.$element.children().length:n.index),r=void 0==n.nested?i.$element:t("optgroup[label='"+n.nested+"']");s.insertAt(e,r),i.generateLisFromOption(s.get(0),e,n.nested)}})},escapeHTML:function(e){return t("<div>").text(e).html()},activeKeyboard:function(e){var i=this;e.on("focus",function(){t(this).addClass("ms-focus")}).on("blur",function(){t(this).removeClass("ms-focus")}).on("keydown",function(n){switch(n.which){case 40:case 38:return n.preventDefault(),n.stopPropagation(),void i.moveHighlight(t(this),38===n.which?-1:1);case 37:case 39:return n.preventDefault(),n.stopPropagation(),void i.switchList(e);case 9:if(i.$element.is("[tabindex]")){n.preventDefault();var s=parseInt(i.$element.attr("tabindex"),10);return s=n.shiftKey?s-1:s+1,void t('[tabindex="'+s+'"]').focus()}n.shiftKey&&i.$element.trigger("focus")}if(t.inArray(n.which,i.options.keySelect)>-1)return n.preventDefault(),n.stopPropagation(),void i.selectHighlighted(e)})},moveHighlight:function(t,e){var i=t.find(this.elemsSelector),n=i.filter(".ms-hover"),s=null,r=i.first().outerHeight(),o=t.height();"#"+this.$container.prop("id");if(i.removeClass("ms-hover"),1===e){if(s=n.nextAll(this.elemsSelector).first(),0===s.length){var a=n.parent();if(a.hasClass("ms-optgroup")){var l=a.parent(),h=l.next(":visible");s=h.length>0?h.find(this.elemsSelector).first():i.first()}else s=i.first()}}else if(e===-1&&(s=n.prevAll(this.elemsSelector).first(),0===s.length)){var a=n.parent();if(a.hasClass("ms-optgroup")){var l=a.parent(),c=l.prev(":visible");s=c.length>0?c.find(this.elemsSelector).last():i.last()}else s=i.last()}if(s.length>0){s.addClass("ms-hover");var u=t.scrollTop()+s.position().top-o/2+r/2;t.scrollTop(u)}},selectHighlighted:function(t){var e=t.find(this.elemsSelector),i=e.filter(".ms-hover").first();i.length>0&&(t.parent().hasClass("ms-selectable")?this.select(i.data("ms-value")):this.deselect(i.data("ms-value")),e.removeClass("ms-hover"))},switchList:function(t){t.blur(),this.$container.find(this.elemsSelector).removeClass("ms-hover"),t.parent().hasClass("ms-selectable")?this.$selectionUl.focus():this.$selectableUl.focus()},activeMouse:function(e){var i=this;t("body").on("mouseenter",i.elemsSelector,function(){t(this).parents(".ms-container").find(i.elemsSelector).removeClass("ms-hover"),t(this).addClass("ms-hover")})},refresh:function(){this.destroy(),this.$element.multiSelect(this.options)},destroy:function(){t("#ms-"+this.$element.attr("id")).remove(),this.$element.css("position","").css("left",""),this.$element.removeData("multiselect")},select:function(e,i){"string"==typeof e&&(e=[e]);var n=this,s=this.$element,r=t.map(e,function(t){return n.sanitize(t)}),o=this.$selectableUl.find("#"+r.join("-selectable, #")+"-selectable").filter(":not(."+n.options.disabledClass+")"),a=this.$selectionUl.find("#"+r.join("-selection, #")+"-selection").filter(":not(."+n.options.disabledClass+")"),l=s.find("option:not(:disabled)").filter(function(){return t.inArray(this.value,e)>-1});if("init"===i&&(o=this.$selectableUl.find("#"+r.join("-selectable, #")+"-selectable"),a=this.$selectionUl.find("#"+r.join("-selection, #")+"-selection")),o.length>0){o.addClass("ms-selected").hide(),a.addClass("ms-selected").show(),l.prop("selected",!0),n.$container.find(n.elemsSelector).removeClass("ms-hover");var h=n.$selectableUl.children(".ms-optgroup-container");if(h.length>0){h.each(function(){var e=t(this).find(".ms-elem-selectable");e.length===e.filter(".ms-selected").length&&t(this).find(".ms-optgroup-label").hide()});var c=n.$selectionUl.children(".ms-optgroup-container");c.each(function(){var e=t(this).find(".ms-elem-selection");e.filter(".ms-selected").length>0&&t(this).find(".ms-optgroup-label").show()})}else if(n.options.keepOrder&&"init"!==i){var u=n.$selectionUl.find(".ms-selected");u.length>1&&u.last().get(0)!=a.get(0)&&a.insertAfter(u.last())}"init"!==i&&(s.trigger("change"),"function"==typeof n.options.afterSelect&&n.options.afterSelect.call(this,e))}},deselect:function(e){"string"==typeof e&&(e=[e]);var i=this,n=this.$element,s=t.map(e,function(t){return i.sanitize(t)}),r=this.$selectableUl.find("#"+s.join("-selectable, #")+"-selectable"),o=this.$selectionUl.find("#"+s.join("-selection, #")+"-selection").filter(".ms-selected").filter(":not(."+i.options.disabledClass+")"),a=n.find("option").filter(function(){return t.inArray(this.value,e)>-1});if(o.length>0){r.removeClass("ms-selected").show(),o.removeClass("ms-selected").hide(),a.prop("selected",!1),i.$container.find(i.elemsSelector).removeClass("ms-hover");var l=i.$selectableUl.children(".ms-optgroup-container");if(l.length>0){l.each(function(){var e=t(this).find(".ms-elem-selectable");e.filter(":not(.ms-selected)").length>0&&t(this).find(".ms-optgroup-label").show()});var h=i.$selectionUl.children(".ms-optgroup-container");h.each(function(){var e=t(this).find(".ms-elem-selection");0===e.filter(".ms-selected").length&&t(this).find(".ms-optgroup-label").hide()})}n.trigger("change"),"function"==typeof i.options.afterDeselect&&i.options.afterDeselect.call(this,e)}},select_all:function(){var e=this.$element,i=e.val();if(e.find('option:not(":disabled")').prop("selected",!0),this.$selectableUl.find(".ms-elem-selectable").filter(":not(."+this.options.disabledClass+")").addClass("ms-selected").hide(),this.$selectionUl.find(".ms-optgroup-label").show(),this.$selectableUl.find(".ms-optgroup-label").hide(),this.$selectionUl.find(".ms-elem-selection").filter(":not(."+this.options.disabledClass+")").addClass("ms-selected").show(),this.$selectionUl.focus(),e.trigger("change"),"function"==typeof this.options.afterSelect){var n=t.grep(e.val(),function(e){return t.inArray(e,i)<0});this.options.afterSelect.call(this,n)}},deselect_all:function(){var t=this.$element,e=t.val();t.find("option").prop("selected",!1),this.$selectableUl.find(".ms-elem-selectable").removeClass("ms-selected").show(),this.$selectionUl.find(".ms-optgroup-label").hide(),this.$selectableUl.find(".ms-optgroup-label").show(),this.$selectionUl.find(".ms-elem-selection").removeClass("ms-selected").hide(),this.$selectableUl.focus(),t.trigger("change"),"function"==typeof this.options.afterDeselect&&this.options.afterDeselect.call(this,e)},sanitize:function(t){var e,i,n=0;if(0==t.length)return n;var s=0;for(e=0,s=t.length;e<s;e++)i=t.charCodeAt(e),n=(n<<5)-n+i,n|=0;return n}},t.fn.multiSelect=function(){var i=arguments[0],n=arguments;return this.each(function(){var s=t(this),r=s.data("multiselect"),o=t.extend({},t.fn.multiSelect.defaults,s.data(),"object"==typeof i&&i);r||s.data("multiselect",r=new e(this,o)),"string"==typeof i?r[i](n[1]):r.init()})},t.fn.multiSelect.defaults={keySelect:[32],selectableOptgroup:!1,disabledClass:"disabled",dblClick:!1,keepOrder:!1,cssClass:""},t.fn.multiSelect.Constructor=e,t.fn.insertAt=function(t,e){return this.each(function(){0===t?e.prepend(this):e.children().eq(t-1).after(this)})}}(window.jQuery),function(t,e,i){!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):jQuery&&!jQuery.fn.sparkline&&t(jQuery)}(function(n){"use strict";var s,r,o,a,l,h,c,u,p,d,g,f,m,v,y,x,b,C,w,R,S,$,k,E,_,M,T,D,I,A,O,P,H={},L=0;s=function(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:i,normalRangeMax:i,normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:i,chartRangeMax:i,chartRangeMinX:i,chartRangeMaxX:i,tooltipFormat:new o('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:i,nullColor:i,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:i,chartRangeMin:i,chartRangeClip:!1,colorMap:i,tooltipFormat:new o('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new o('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:i,thresholdValue:0,chartRangeMax:i,chartRangeMin:i,chartRangeClip:!1,tooltipFormat:new o("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:i,tooltipFormat:new o("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new o('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:i,targetColor:"#4a2",chartRangeMax:i,chartRangeMin:i,tooltipFormat:new o("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}},M='.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}',r=function(){var t,e;return t=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(t.prototype=n.extend(new arguments[0],arguments[arguments.length-1]),t._super=arguments[0].prototype):t.prototype=arguments[arguments.length-1],arguments.length>2&&(e=Array.prototype.slice.call(arguments,1,-1),e.unshift(t.prototype),n.extend.apply(n,e))):t.prototype=arguments[0],t.prototype.cls=t,t},n.SPFormatClass=o=r({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(t,e){this.format=t,this.fclass=e},render:function(t,e,n){var s,r,o,a,l,h=this,c=t;return this.format.replace(this.fre,function(){var t;return r=arguments[1],o=arguments[3],s=h.precre.exec(r),s?(l=s[2],r=s[1]):l=!1,a=c[r],a===i?"":o&&e&&e[o]?(t=e[o],t.get?e[o].get(a)||a:e[o][a]||a):(p(a)&&(a=n.get("numberFormatter")?n.get("numberFormatter")(a):v(a,l,n.get("numberDigitGroupCount"),n.get("numberDigitGroupSep"),n.get("numberDecimalMark"))),a)})}}),n.spformat=function(t,e){return new o(t,e)},a=function(t,e,i){return t<e?e:t>i?i:t},l=function(t,i){var n;return 2===i?(n=e.floor(t.length/2),t.length%2?t[n]:(t[n-1]+t[n])/2):t.length%2?(n=(t.length*i+i)/4,n%1?(t[e.floor(n)]+t[e.floor(n)-1])/2:t[n-1]):(n=(t.length*i+2)/4,n%1?(t[e.floor(n)]+t[e.floor(n)-1])/2:t[n-1])},h=function(t){var e;switch(t){case"undefined":t=i;break;case"null":t=null;break;case"true":t=!0;break;case"false":t=!1;break;default:e=parseFloat(t),t==e&&(t=e)}return t},c=function(t){var e,i=[];for(e=t.length;e--;)i[e]=h(t[e]);return i},u=function(t,e){var i,n,s=[];for(i=0,n=t.length;i<n;i++)t[i]!==e&&s.push(t[i]);return s},p=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},v=function(t,e,i,s,r){var o,a;for(t=(e===!1?parseFloat(t).toString():t.toFixed(e)).split(""),o=(o=n.inArray(".",t))<0?t.length:o,o<t.length&&(t[o]=r),a=o-i;a>0;a-=i)t.splice(a,0,s);return t.join("")},d=function(t,e,i){var n;for(n=e.length;n--;)if((!i||null!==e[n])&&e[n]!==t)return!1;return!0},g=function(t){var e,i=0;for(e=t.length;e--;)i+="number"==typeof t[e]?t[e]:0;return i},m=function(t){return n.isArray(t)?t:[t]},f=function(e){var i;t.createStyleSheet?t.createStyleSheet().cssText=e:(i=t.createElement("style"),i.type="text/css",t.getElementsByTagName("head")[0].appendChild(i),i["string"==typeof t.body.style.WebkitAppearance?"innerText":"innerHTML"]=e)},n.fn.simpledraw=function(e,s,r,o){var a,l;if(r&&(a=this.data("_jqs_vcanvas")))return a;if(n.fn.sparkline.canvas===!1)return!1;if(n.fn.sparkline.canvas===i){var h=t.createElement("canvas");if(h.getContext&&h.getContext("2d"))n.fn.sparkline.canvas=function(t,e,i,n){return new A(t,e,i,n)};else{if(!t.namespaces||t.namespaces.v)return n.fn.sparkline.canvas=!1,!1;t.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),n.fn.sparkline.canvas=function(t,e,i,n){return new O(t,e,i)}}}return e===i&&(e=n(this).innerWidth()),s===i&&(s=n(this).innerHeight()),a=n.fn.sparkline.canvas(e,s,this,o),l=n(this).data("_jqs_mhandler"),l&&l.registerCanvas(a),a},n.fn.cleardraw=function(){var t=this.data("_jqs_vcanvas");t&&t.reset()},n.RangeMapClass=y=r({init:function(t){var e,i,n=[];for(e in t)t.hasOwnProperty(e)&&"string"==typeof e&&e.indexOf(":")>-1&&(i=e.split(":"),i[0]=0===i[0].length?-(1/0):parseFloat(i[0]),i[1]=0===i[1].length?1/0:parseFloat(i[1]),i[2]=t[e],n.push(i));this.map=t,this.rangelist=n||!1},get:function(t){var e,n,s,r=this.rangelist;if((s=this.map[t])!==i)return s;if(r)for(e=r.length;e--;)if(n=r[e],n[0]<=t&&n[1]>=t)return n[2];return i}}),n.range_map=function(t){return new y(t)},x=r({init:function(t,e){var i=n(t);this.$el=i,this.options=e,this.currentPageX=0,this.currentPageY=0,this.el=t,this.splist=[],
this.tooltip=null,this.over=!1,this.displayTooltips=!e.get("disableTooltips"),this.highlightEnabled=!e.get("disableHighlight")},registerSparkline:function(t){this.splist.push(t),this.over&&this.updateDisplay()},registerCanvas:function(t){var e=n(t.canvas);this.canvas=t,this.$canvas=e,e.mouseenter(n.proxy(this.mouseenter,this)),e.mouseleave(n.proxy(this.mouseleave,this)),e.click(n.proxy(this.mouseclick,this))},reset:function(t){this.splist=[],this.tooltip&&t&&(this.tooltip.remove(),this.tooltip=i)},mouseclick:function(t){var e=n.Event("sparklineClick");e.originalEvent=t,e.sparklines=this.splist,this.$el.trigger(e)},mouseenter:function(e){n(t.body).unbind("mousemove.jqs"),n(t.body).bind("mousemove.jqs",n.proxy(this.mousemove,this)),this.over=!0,this.currentPageX=e.pageX,this.currentPageY=e.pageY,this.currentEl=e.target,!this.tooltip&&this.displayTooltips&&(this.tooltip=new b(this.options),this.tooltip.updatePosition(e.pageX,e.pageY)),this.updateDisplay()},mouseleave:function(){n(t.body).unbind("mousemove.jqs");var e,i,s=this.splist,r=s.length,o=!1;for(this.over=!1,this.currentEl=null,this.tooltip&&(this.tooltip.remove(),this.tooltip=null),i=0;i<r;i++)e=s[i],e.clearRegionHighlight()&&(o=!0);o&&this.canvas.render()},mousemove:function(t){this.currentPageX=t.pageX,this.currentPageY=t.pageY,this.currentEl=t.target,this.tooltip&&this.tooltip.updatePosition(t.pageX,t.pageY),this.updateDisplay()},updateDisplay:function(){var t,e,i,s,r,o=this.splist,a=o.length,l=!1,h=this.$canvas.offset(),c=this.currentPageX-h.left,u=this.currentPageY-h.top;if(this.over){for(i=0;i<a;i++)e=o[i],s=e.setRegionHighlight(this.currentEl,c,u),s&&(l=!0);if(l){if(r=n.Event("sparklineRegionChange"),r.sparklines=this.splist,this.$el.trigger(r),this.tooltip){for(t="",i=0;i<a;i++)e=o[i],t+=e.getCurrentRegionTooltip();this.tooltip.setContent(t)}this.disableHighlight||this.canvas.render()}null===s&&this.mouseleave()}}}),b=r({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(e){var i,s=e.get("tooltipClassname","jqstooltip"),r=this.sizeStyle;this.container=e.get("tooltipContainer")||t.body,this.tooltipOffsetX=e.get("tooltipOffsetX",10),this.tooltipOffsetY=e.get("tooltipOffsetY",12),n("#jqssizetip").remove(),n("#jqstooltip").remove(),this.sizetip=n("<div/>",{id:"jqssizetip",style:r,"class":s}),this.tooltip=n("<div/>",{id:"jqstooltip","class":s}).appendTo(this.container),i=this.tooltip.offset(),this.offsetLeft=i.left,this.offsetTop=i.top,this.hidden=!0,n(window).unbind("resize.jqs scroll.jqs"),n(window).bind("resize.jqs scroll.jqs",n.proxy(this.updateWindowDims,this)),this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=n(window).scrollTop(),this.scrollLeft=n(window).scrollLeft(),this.scrollRight=this.scrollLeft+n(window).width(),this.updatePosition()},getSize:function(t){this.sizetip.html(t).appendTo(this.container),this.width=this.sizetip.width()+1,this.height=this.sizetip.height(),this.sizetip.remove()},setContent:function(t){return t?(this.getSize(t),this.tooltip.html(t).css({width:this.width,height:this.height,visibility:"visible"}),void(this.hidden&&(this.hidden=!1,this.updatePosition()))):(this.tooltip.css("visibility","hidden"),void(this.hidden=!0))},updatePosition:function(t,e){if(t===i){if(this.mousex===i)return;t=this.mousex-this.offsetLeft,e=this.mousey-this.offsetTop}else this.mousex=t-=this.offsetLeft,this.mousey=e-=this.offsetTop;this.height&&this.width&&!this.hidden&&(e-=this.height+this.tooltipOffsetY,t+=this.tooltipOffsetX,e<this.scrollTop&&(e=this.scrollTop),t<this.scrollLeft?t=this.scrollLeft:t+this.width>this.scrollRight&&(t=this.scrollRight-this.width),this.tooltip.css({left:t,top:e}))},remove:function(){this.tooltip.remove(),this.sizetip.remove(),this.sizetip=this.tooltip=i,n(window).unbind("resize.jqs scroll.jqs")}}),T=function(){f(M)},n(T),P=[],n.fn.sparkline=function(e,s){return this.each(function(){var r,o,a=new n.fn.sparkline.options(this,s),l=n(this);if(r=function(){var s,r,o,h,c,u,p;return"html"===e||e===i?(p=this.getAttribute(a.get("tagValuesAttribute")),p!==i&&null!==p||(p=l.html()),s=p.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")):s=e,r="auto"===a.get("width")?s.length*a.get("defaultPixelsPerValue"):a.get("width"),"auto"===a.get("height")?a.get("composite")&&n.data(this,"_jqs_vcanvas")||(h=t.createElement("span"),h.innerHTML="a",l.html(h),o=n(h).innerHeight()||n(h).height(),n(h).remove(),h=null):o=a.get("height"),a.get("disableInteraction")?c=!1:(c=n.data(this,"_jqs_mhandler"),c?a.get("composite")||c.reset():(c=new x(this,a),n.data(this,"_jqs_mhandler",c))),a.get("composite")&&!n.data(this,"_jqs_vcanvas")?void(n.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),n.data(this,"_jqs_errnotify",!0))):(u=new(n.fn.sparkline[a.get("type")])(this,s,a,r,o),u.render(),void(c&&c.registerSparkline(u)))},n(this).html()&&!a.get("disableHiddenCheck")&&n(this).is(":hidden")||!n(this).parents("body").length){if(!a.get("composite")&&n.data(this,"_jqs_pending"))for(o=P.length;o;o--)P[o-1][0]==this&&P.splice(o-1,1);P.push([this,r]),n.data(this,"_jqs_pending",!0)}else r.call(this)})},n.fn.sparkline.defaults=s(),n.sparkline_display_visible=function(){var t,e,i,s=[];for(e=0,i=P.length;e<i;e++)t=P[e][0],n(t).is(":visible")&&!n(t).parents().is(":hidden")?(P[e][1].call(t),n.data(P[e][0],"_jqs_pending",!1),s.push(e)):n(t).closest("html").length||n.data(t,"_jqs_pending")||(n.data(P[e][0],"_jqs_pending",!1),s.push(e));for(e=s.length;e;e--)P.splice(s[e-1],1)},n.fn.sparkline.options=r({init:function(t,e){var i,s,r,o;this.userOptions=e=e||{},this.tag=t,this.tagValCache={},s=n.fn.sparkline.defaults,r=s.common,this.tagOptionsPrefix=e.enableTagOptions&&(e.tagOptionsPrefix||r.tagOptionsPrefix),o=this.getTagSetting("type"),i=o===H?s[e.type||r.type]:s[o],this.mergedOptions=n.extend({},r,i,e)},getTagSetting:function(t){var e,n,s,r,o=this.tagOptionsPrefix;if(o===!1||o===i)return H;if(this.tagValCache.hasOwnProperty(t))e=this.tagValCache.key;else{if(e=this.tag.getAttribute(o+t),e===i||null===e)e=H;else if("["===e.substr(0,1))for(e=e.substr(1,e.length-2).split(","),n=e.length;n--;)e[n]=h(e[n].replace(/(^\s*)|(\s*$)/g,""));else if("{"===e.substr(0,1))for(s=e.substr(1,e.length-2).split(","),e={},n=s.length;n--;)r=s[n].split(":",2),e[r[0].replace(/(^\s*)|(\s*$)/g,"")]=h(r[1].replace(/(^\s*)|(\s*$)/g,""));else e=h(e);this.tagValCache.key=e}return e},get:function(t,e){var n,s=this.getTagSetting(t);return s!==H?s:(n=this.mergedOptions[t])===i?e:n}}),n.fn.sparkline._base=r({disabled:!1,init:function(t,e,s,r,o){this.el=t,this.$el=n(t),this.values=e,this.options=s,this.width=r,this.height=o,this.currentRegion=i},initTarget:function(){var t=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),t))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return!this.disabled||(this.el.innerHTML="",!1)},getRegion:function(t,e){},setRegionHighlight:function(t,e,n){var s,r=this.currentRegion,o=!this.options.get("disableHighlight");return e>this.canvasWidth||n>this.canvasHeight||e<0||n<0?null:(s=this.getRegion(t,e,n),r!==s&&(r!==i&&o&&this.removeHighlight(),this.currentRegion=s,s!==i&&o&&this.renderHighlight(),!0))},clearRegionHighlight:function(){return this.currentRegion!==i&&(this.removeHighlight(),this.currentRegion=i,!0)},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(t){},getCurrentRegionTooltip:function(){var t,e,s,r,a,l,h,c,u,p,d,g,f,m,v=this.options,y="",x=[];if(this.currentRegion===i)return"";if(t=this.getCurrentRegionFields(),d=v.get("tooltipFormatter"))return d(this,v,t);if(v.get("tooltipChartTitle")&&(y+='<div class="jqs jqstitle">'+v.get("tooltipChartTitle")+"</div>\n"),e=this.options.get("tooltipFormat"),!e)return"";if(n.isArray(e)||(e=[e]),n.isArray(t)||(t=[t]),h=this.options.get("tooltipFormatFieldlist"),c=this.options.get("tooltipFormatFieldlistKey"),h&&c){for(u=[],l=t.length;l--;)p=t[l][c],(m=n.inArray(p,h))!=-1&&(u[m]=t[l]);t=u}for(s=e.length,f=t.length,l=0;l<s;l++)for(g=e[l],"string"==typeof g&&(g=new o(g)),r=g.fclass||"jqsfield",m=0;m<f;m++)t[m].isNull&&v.get("tooltipSkipNull")||(n.extend(t[m],{prefix:v.get("tooltipPrefix"),suffix:v.get("tooltipSuffix")}),a=g.render(t[m],v.get("tooltipValueLookups"),v),x.push('<div class="'+r+'">'+a+"</div>"));return x.length?y+x.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(t,i){var n,s,r,o,l=i.get("highlightColor"),h=i.get("highlightLighten");if(l)return l;if(h&&(n=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(t)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(t))){for(r=[],s=4===t.length?16:1,o=0;o<3;o++)r[o]=a(e.round(parseInt(n[o+1],16)*s*h),0,255);return"rgb("+r.join(",")+")"}return t}}),C={changeHighlight:function(t){var e,i=this.currentRegion,s=this.target,r=this.regionShapes[i];r&&(e=this.renderRegion(i,t),n.isArray(e)||n.isArray(r)?(s.replaceWithShapes(r,e),this.regionShapes[i]=n.map(e,function(t){return t.id})):(s.replaceWithShape(r,e),this.regionShapes[i]=e.id))},render:function(){var t,e,i,s,r=this.values,o=this.target,a=this.regionShapes;if(this.cls._super.render.call(this)){for(i=r.length;i--;)if(t=this.renderRegion(i))if(n.isArray(t)){for(e=[],s=t.length;s--;)t[s].append(),e.push(t[s].id);a[i]=e}else t.append(),a[i]=t.id;else a[i]=null;o.render()}}},n.fn.sparkline.line=w=r(n.fn.sparkline._base,{type:"line",init:function(t,e,i,n,s){w._super.init.call(this,t,e,i,n,s),this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.initTarget()},getRegion:function(t,e,n){var s,r=this.regionMap;for(s=r.length;s--;)if(null!==r[s]&&e>=r[s][0]&&e<=r[s][1])return r[s][2];return i},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:null===this.yvalues[t],x:this.xvalues[t],y:this.yvalues[t],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:t}},renderHighlight:function(){var t,e,n=this.currentRegion,s=this.target,r=this.vertices[n],o=this.options,a=o.get("spotRadius"),l=o.get("highlightSpotColor"),h=o.get("highlightLineColor");r&&(a&&l&&(t=s.drawCircle(r[0],r[1],a,i,l),this.highlightSpotId=t.id,s.insertAfterShape(this.lastShapeId,t)),h&&(e=s.drawLine(r[0],this.canvasTop,r[0],this.canvasTop+this.canvasHeight,h),this.highlightLineId=e.id,s.insertAfterShape(this.lastShapeId,e)))},removeHighlight:function(){var t=this.target;this.highlightSpotId&&(t.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(t.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var t,i,n,s,r,o=this.values,a=o.length,l=this.xvalues,h=this.yvalues,c=this.yminmax;for(t=0;t<a;t++)i=o[t],n="string"==typeof o[t],s="object"==typeof o[t]&&o[t]instanceof Array,r=n&&o[t].split(":"),n&&2===r.length?(l.push(Number(r[0])),h.push(Number(r[1])),c.push(Number(r[1]))):s?(l.push(i[0]),h.push(i[1]),c.push(i[1])):(l.push(t),null===o[t]||"null"===o[t]?h.push(null):(h.push(Number(i)),c.push(Number(i))));this.options.get("xvalues")&&(l=this.options.get("xvalues")),this.maxy=this.maxyorg=e.max.apply(e,c),this.miny=this.minyorg=e.min.apply(e,c),this.maxx=e.max.apply(e,l),this.minx=e.min.apply(e,l),this.xvalues=l,this.yvalues=h,this.yminmax=c},processRangeOptions:function(){var t=this.options,e=t.get("normalRangeMin"),n=t.get("normalRangeMax");e!==i&&(e<this.miny&&(this.miny=e),n>this.maxy&&(this.maxy=n)),t.get("chartRangeMin")!==i&&(t.get("chartRangeClip")||t.get("chartRangeMin")<this.miny)&&(this.miny=t.get("chartRangeMin")),t.get("chartRangeMax")!==i&&(t.get("chartRangeClip")||t.get("chartRangeMax")>this.maxy)&&(this.maxy=t.get("chartRangeMax")),t.get("chartRangeMinX")!==i&&(t.get("chartRangeClipX")||t.get("chartRangeMinX")<this.minx)&&(this.minx=t.get("chartRangeMinX")),t.get("chartRangeMaxX")!==i&&(t.get("chartRangeClipX")||t.get("chartRangeMaxX")>this.maxx)&&(this.maxx=t.get("chartRangeMaxX"))},drawNormalRange:function(t,n,s,r,o){var a=this.options.get("normalRangeMin"),l=this.options.get("normalRangeMax"),h=n+e.round(s-s*((l-this.miny)/o)),c=e.round(s*(l-a)/o);this.target.drawRect(t,h,r,c,i,this.options.get("normalRangeColor")).append()},render:function(){var t,s,r,o,a,l,h,c,u,p,d,g,f,m,v,x,b,C,R,S,$,k,E,_,M,T=this.options,D=this.target,I=this.canvasWidth,A=this.canvasHeight,O=this.vertices,P=T.get("spotRadius"),H=this.regionMap;if(w._super.render.call(this)&&(this.scanValues(),this.processRangeOptions(),E=this.xvalues,_=this.yvalues,this.yminmax.length&&!(this.yvalues.length<2))){for(o=a=0,t=this.maxx-this.minx===0?1:this.maxx-this.minx,s=this.maxy-this.miny===0?1:this.maxy-this.miny,r=this.yvalues.length-1,P&&(I<4*P||A<4*P)&&(P=0),P&&($=T.get("highlightSpotColor")&&!T.get("disableInteraction"),($||T.get("minSpotColor")||T.get("spotColor")&&_[r]===this.miny)&&(A-=e.ceil(P)),($||T.get("maxSpotColor")||T.get("spotColor")&&_[r]===this.maxy)&&(A-=e.ceil(P),o+=e.ceil(P)),($||(T.get("minSpotColor")||T.get("maxSpotColor"))&&(_[0]===this.miny||_[0]===this.maxy))&&(a+=e.ceil(P),I-=e.ceil(P)),($||T.get("spotColor")||T.get("minSpotColor")||T.get("maxSpotColor")&&(_[r]===this.miny||_[r]===this.maxy))&&(I-=e.ceil(P))),A--,T.get("normalRangeMin")===i||T.get("drawNormalOnTop")||this.drawNormalRange(a,o,A,I,s),h=[],c=[h],m=v=null,x=_.length,M=0;M<x;M++)u=E[M],d=E[M+1],p=_[M],g=a+e.round((u-this.minx)*(I/t)),f=M<x-1?a+e.round((d-this.minx)*(I/t)):I,v=g+(f-g)/2,H[M]=[m||0,v,M],m=v,null===p?M&&(null!==_[M-1]&&(h=[],c.push(h)),O.push(null)):(p<this.miny&&(p=this.miny),p>this.maxy&&(p=this.maxy),h.length||h.push([g,o+A]),l=[g,o+e.round(A-A*((p-this.miny)/s))],h.push(l),O.push(l));for(b=[],C=[],R=c.length,M=0;M<R;M++)h=c[M],h.length&&(T.get("fillColor")&&(h.push([h[h.length-1][0],o+A]),C.push(h.slice(0)),h.pop()),h.length>2&&(h[0]=[h[0][0],h[1][1]]),b.push(h));for(R=C.length,M=0;M<R;M++)D.drawShape(C[M],T.get("fillColor"),T.get("fillColor")).append();for(T.get("normalRangeMin")!==i&&T.get("drawNormalOnTop")&&this.drawNormalRange(a,o,A,I,s),R=b.length,M=0;M<R;M++)D.drawShape(b[M],T.get("lineColor"),i,T.get("lineWidth")).append();if(P&&T.get("valueSpots"))for(S=T.get("valueSpots"),S.get===i&&(S=new y(S)),M=0;M<x;M++)k=S.get(_[M]),k&&D.drawCircle(a+e.round((E[M]-this.minx)*(I/t)),o+e.round(A-A*((_[M]-this.miny)/s)),P,i,k).append();P&&T.get("spotColor")&&null!==_[r]&&D.drawCircle(a+e.round((E[E.length-1]-this.minx)*(I/t)),o+e.round(A-A*((_[r]-this.miny)/s)),P,i,T.get("spotColor")).append(),this.maxy!==this.minyorg&&(P&&T.get("minSpotColor")&&(u=E[n.inArray(this.minyorg,_)],D.drawCircle(a+e.round((u-this.minx)*(I/t)),o+e.round(A-A*((this.minyorg-this.miny)/s)),P,i,T.get("minSpotColor")).append()),P&&T.get("maxSpotColor")&&(u=E[n.inArray(this.maxyorg,_)],D.drawCircle(a+e.round((u-this.minx)*(I/t)),o+e.round(A-A*((this.maxyorg-this.miny)/s)),P,i,T.get("maxSpotColor")).append())),this.lastShapeId=D.getLastShapeId(),this.canvasTop=o,D.render()}}}),n.fn.sparkline.bar=R=r(n.fn.sparkline._base,C,{type:"bar",init:function(t,s,r,o,l){var p,d,g,f,m,v,x,b,C,w,S,$,k,E,_,M,T,D,I,A,O,P,H=parseInt(r.get("barWidth"),10),L=parseInt(r.get("barSpacing"),10),N=r.get("chartRangeMin"),j=r.get("chartRangeMax"),F=r.get("chartRangeClip"),W=1/0,q=-(1/0);for(R._super.init.call(this,t,s,r,o,l),v=0,x=s.length;v<x;v++)A=s[v],p="string"==typeof A&&A.indexOf(":")>-1,(p||n.isArray(A))&&(_=!0,p&&(A=s[v]=c(A.split(":"))),A=u(A,null),d=e.min.apply(e,A),g=e.max.apply(e,A),d<W&&(W=d),g>q&&(q=g));this.stacked=_,this.regionShapes={},this.barWidth=H,this.barSpacing=L,this.totalBarWidth=H+L,this.width=o=s.length*H+(s.length-1)*L,this.initTarget(),F&&(k=N===i?-(1/0):N,E=j===i?1/0:j),m=[],f=_?[]:m;var U=[],B=[];for(v=0,x=s.length;v<x;v++)if(_)for(M=s[v],s[v]=I=[],U[v]=0,f[v]=B[v]=0,T=0,D=M.length;T<D;T++)A=I[T]=F?a(M[T],k,E):M[T],null!==A&&(A>0&&(U[v]+=A),W<0&&q>0?A<0?B[v]+=e.abs(A):f[v]+=A:f[v]+=e.abs(A-(A<0?q:W)),m.push(A));else A=F?a(s[v],k,E):s[v],A=s[v]=h(A),null!==A&&m.push(A);this.max=$=e.max.apply(e,m),this.min=S=e.min.apply(e,m),this.stackMax=q=_?e.max.apply(e,U):$,this.stackMin=W=_?e.min.apply(e,m):S,r.get("chartRangeMin")!==i&&(r.get("chartRangeClip")||r.get("chartRangeMin")<S)&&(S=r.get("chartRangeMin")),r.get("chartRangeMax")!==i&&(r.get("chartRangeClip")||r.get("chartRangeMax")>$)&&($=r.get("chartRangeMax")),this.zeroAxis=C=r.get("zeroAxis",!0),w=S<=0&&$>=0&&C?0:0==C?S:S>0?S:$,this.xaxisOffset=w,b=_?e.max.apply(e,f)+e.max.apply(e,B):$-S,this.canvasHeightEf=C&&S<0?this.canvasHeight-2:this.canvasHeight-1,S<w?(P=_&&$>=0?q:$,O=(P-w)/b*this.canvasHeight,O!==e.ceil(O)&&(this.canvasHeightEf-=2,O=e.ceil(O))):O=this.canvasHeight,this.yoffset=O,n.isArray(r.get("colorMap"))?(this.colorMapByIndex=r.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=r.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===i&&(this.colorMapByValue=new y(this.colorMapByValue))),this.range=b},getRegion:function(t,n,s){var r=e.floor(n/this.totalBarWidth);return r<0||r>=this.values.length?i:r},getCurrentRegionFields:function(){var t,e,i=this.currentRegion,n=m(this.values[i]),s=[];for(e=n.length;e--;)t=n[e],s.push({isNull:null===t,value:t,color:this.calcColor(e,t,i),offset:i});return s},calcColor:function(t,e,s){var r,o,a=this.colorMapByIndex,l=this.colorMapByValue,h=this.options;return r=this.stacked?h.get("stackedBarColor"):e<0?h.get("negBarColor"):h.get("barColor"),0===e&&h.get("zeroColor")!==i&&(r=h.get("zeroColor")),l&&(o=l.get(e))?r=o:a&&a.length>s&&(r=a[s]),n.isArray(r)?r[t%r.length]:r},renderRegion:function(t,s){var r,o,a,l,h,c,u,p,g,f,m=this.values[t],v=this.options,y=this.xaxisOffset,x=[],b=this.range,C=this.stacked,w=this.target,R=t*this.totalBarWidth,S=this.canvasHeightEf,$=this.yoffset;if(m=n.isArray(m)?m:[m],u=m.length,p=m[0],l=d(null,m),f=d(y,m,!0),l)return v.get("nullColor")?(a=s?v.get("nullColor"):this.calcHighlightColor(v.get("nullColor"),v),r=$>0?$-1:$,w.drawRect(R,r,this.barWidth-1,0,a,a)):i;for(h=$,c=0;c<u;c++){if(p=m[c],C&&p===y){if(!f||g)continue;g=!0}o=b>0?e.floor(S*(e.abs(p-y)/b))+1:1,p<y||p===y&&0===$?(r=h,h+=o):(r=$-o,$-=o),a=this.calcColor(c,p,t),s&&(a=this.calcHighlightColor(a,v)),x.push(w.drawRect(R,r,this.barWidth-1,o-1,a,a))}return 1===x.length?x[0]:x}}),n.fn.sparkline.tristate=S=r(n.fn.sparkline._base,C,{type:"tristate",init:function(t,e,s,r,o){var a=parseInt(s.get("barWidth"),10),l=parseInt(s.get("barSpacing"),10);S._super.init.call(this,t,e,s,r,o),this.regionShapes={},this.barWidth=a,this.barSpacing=l,this.totalBarWidth=a+l,this.values=n.map(e,Number),this.width=r=e.length*a+(e.length-1)*l,n.isArray(s.get("colorMap"))?(this.colorMapByIndex=s.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=s.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===i&&(this.colorMapByValue=new y(this.colorMapByValue))),this.initTarget()},getRegion:function(t,i,n){return e.floor(i/this.totalBarWidth)},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.values[t]===i,value:this.values[t],color:this.calcColor(this.values[t],t),offset:t}},calcColor:function(t,e){var i,n,s=this.values,r=this.options,o=this.colorMapByIndex,a=this.colorMapByValue;return i=a&&(n=a.get(t))?n:o&&o.length>e?o[e]:s[e]<0?r.get("negBarColor"):s[e]>0?r.get("posBarColor"):r.get("zeroBarColor")},renderRegion:function(t,i){var n,s,r,o,a,l,h=this.values,c=this.options,u=this.target;if(n=u.pixelHeight,r=e.round(n/2),o=t*this.totalBarWidth,h[t]<0?(a=r,s=r-1):h[t]>0?(a=0,s=r-1):(a=r-1,s=2),l=this.calcColor(h[t],t),null!==l)return i&&(l=this.calcHighlightColor(l,c)),u.drawRect(o,a,this.barWidth-1,s-1,l,l)}}),n.fn.sparkline.discrete=$=r(n.fn.sparkline._base,C,{type:"discrete",init:function(t,s,r,o,a){$._super.init.call(this,t,s,r,o,a),this.regionShapes={},this.values=s=n.map(s,Number),this.min=e.min.apply(e,s),this.max=e.max.apply(e,s),this.range=this.max-this.min,this.width=o="auto"===r.get("width")?2*s.length:this.width,this.interval=e.floor(o/s.length),this.itemWidth=o/s.length,r.get("chartRangeMin")!==i&&(r.get("chartRangeClip")||r.get("chartRangeMin")<this.min)&&(this.min=r.get("chartRangeMin")),r.get("chartRangeMax")!==i&&(r.get("chartRangeClip")||r.get("chartRangeMax")>this.max)&&(this.max=r.get("chartRangeMax")),this.initTarget(),this.target&&(this.lineHeight="auto"===r.get("lineHeight")?e.round(.3*this.canvasHeight):r.get("lineHeight"))},getRegion:function(t,i,n){return e.floor(i/this.itemWidth)},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.values[t]===i,value:this.values[t],offset:t}},renderRegion:function(t,i){var n,s,r,o,l=this.values,h=this.options,c=this.min,u=this.max,p=this.range,d=this.interval,g=this.target,f=this.canvasHeight,m=this.lineHeight,v=f-m;return s=a(l[t],c,u),o=t*d,n=e.round(v-v*((s-c)/p)),r=h.get("thresholdColor")&&s<h.get("thresholdValue")?h.get("thresholdColor"):h.get("lineColor"),i&&(r=this.calcHighlightColor(r,h)),g.drawLine(o,n,o,n+m,r)}}),n.fn.sparkline.bullet=k=r(n.fn.sparkline._base,{type:"bullet",init:function(t,n,s,r,o){var a,l,h;k._super.init.call(this,t,n,s,r,o),this.values=n=c(n),h=n.slice(),h[0]=null===h[0]?h[2]:h[0],h[1]=null===n[1]?h[2]:h[1],a=e.min.apply(e,n),l=e.max.apply(e,n),a=s.get("base")===i?a<0?a:0:s.get("base"),this.min=a,this.max=l,this.range=l-a,this.shapes={},this.valueShapes={},this.regiondata={},this.width=r="auto"===s.get("width")?"4.0em":r,this.target=this.$el.simpledraw(r,o,s.get("composite")),n.length||(this.disabled=!0),this.initTarget()},getRegion:function(t,e,n){var s=this.target.getShapeAt(t,e,n);return s!==i&&this.shapes[s]!==i?this.shapes[s]:i},getCurrentRegionFields:function(){var t=this.currentRegion;return{fieldkey:t.substr(0,1),value:this.values[t.substr(1)],region:t}},changeHighlight:function(t){var e,i=this.currentRegion,n=this.valueShapes[i];switch(delete this.shapes[n],i.substr(0,1)){case"r":e=this.renderRange(i.substr(1),t);break;case"p":e=this.renderPerformance(t);break;case"t":e=this.renderTarget(t)}this.valueShapes[i]=e.id,this.shapes[e.id]=i,this.target.replaceWithShape(n,e)},renderRange:function(t,i){var n=this.values[t],s=e.round(this.canvasWidth*((n-this.min)/this.range)),r=this.options.get("rangeColors")[t-2];return i&&(r=this.calcHighlightColor(r,this.options)),this.target.drawRect(0,0,s-1,this.canvasHeight-1,r,r)},renderPerformance:function(t){var i=this.values[1],n=e.round(this.canvasWidth*((i-this.min)/this.range)),s=this.options.get("performanceColor");return t&&(s=this.calcHighlightColor(s,this.options)),this.target.drawRect(0,e.round(.3*this.canvasHeight),n-1,e.round(.4*this.canvasHeight)-1,s,s)},renderTarget:function(t){var i=this.values[0],n=e.round(this.canvasWidth*((i-this.min)/this.range)-this.options.get("targetWidth")/2),s=e.round(.1*this.canvasHeight),r=this.canvasHeight-2*s,o=this.options.get("targetColor");return t&&(o=this.calcHighlightColor(o,this.options)),this.target.drawRect(n,s,this.options.get("targetWidth")-1,r-1,o,o)},render:function(){var t,e,i=this.values.length,n=this.target;if(k._super.render.call(this)){for(t=2;t<i;t++)e=this.renderRange(t).append(),this.shapes[e.id]="r"+t,this.valueShapes["r"+t]=e.id;null!==this.values[1]&&(e=this.renderPerformance().append(),this.shapes[e.id]="p1",this.valueShapes.p1=e.id),null!==this.values[0]&&(e=this.renderTarget().append(),this.shapes[e.id]="t0",this.valueShapes.t0=e.id),n.render()}}}),n.fn.sparkline.pie=E=r(n.fn.sparkline._base,{type:"pie",init:function(t,i,s,r,o){var a,l=0;if(E._super.init.call(this,t,i,s,r,o),this.shapes={},this.valueShapes={},this.values=i=n.map(i,Number),"auto"===s.get("width")&&(this.width=this.height),i.length>0)for(a=i.length;a--;)l+=i[a];this.total=l,this.initTarget(),this.radius=e.floor(e.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(t,e,n){var s=this.target.getShapeAt(t,e,n);return s!==i&&this.shapes[s]!==i?this.shapes[s]:i},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.values[t]===i,value:this.values[t],percent:this.values[t]/this.total*100,color:this.options.get("sliceColors")[t%this.options.get("sliceColors").length],offset:t}},changeHighlight:function(t){var e=this.currentRegion,i=this.renderSlice(e,t),n=this.valueShapes[e];delete this.shapes[n],this.target.replaceWithShape(n,i),this.valueShapes[e]=i.id,this.shapes[i.id]=e},renderSlice:function(t,n){var s,r,o,a,l,h=this.target,c=this.options,u=this.radius,p=c.get("borderWidth"),d=c.get("offset"),g=2*e.PI,f=this.values,m=this.total,v=d?2*e.PI*(d/360):0;for(a=f.length,o=0;o<a;o++){if(s=v,r=v,m>0&&(r=v+g*(f[o]/m)),t===o)return l=c.get("sliceColors")[o%c.get("sliceColors").length],n&&(l=this.calcHighlightColor(l,c)),h.drawPieSlice(u,u,u-p,s,r,i,l);v=r}},render:function(){var t,n,s=this.target,r=this.values,o=this.options,a=this.radius,l=o.get("borderWidth");if(E._super.render.call(this)){for(l&&s.drawCircle(a,a,e.floor(a-l/2),o.get("borderColor"),i,l).append(),n=r.length;n--;)r[n]&&(t=this.renderSlice(n).append(),this.valueShapes[n]=t.id,this.shapes[t.id]=n);s.render()}}}),n.fn.sparkline.box=_=r(n.fn.sparkline._base,{type:"box",init:function(t,e,i,s,r){_._super.init.call(this,t,e,i,s,r),this.values=n.map(e,Number),this.width="auto"===i.get("width")?"4.0em":s,this.initTarget(),this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var t=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return this.loutlier!==i&&t.push({field:"lo",value:this.loutlier}),this.routlier!==i&&t.push({field:"ro",value:this.routlier}),this.lwhisker!==i&&t.push({field:"lw",value:this.lwhisker}),this.rwhisker!==i&&t.push({field:"rw",value:this.rwhisker}),t},render:function(){var t,n,s,r,o,a,h,c,u,p,d,g=this.target,f=this.values,m=f.length,v=this.options,y=this.canvasWidth,x=this.canvasHeight,b=v.get("chartRangeMin")===i?e.min.apply(e,f):v.get("chartRangeMin"),C=v.get("chartRangeMax")===i?e.max.apply(e,f):v.get("chartRangeMax"),w=0;if(_._super.render.call(this)){if(v.get("raw"))v.get("showOutliers")&&f.length>5?(n=f[0],t=f[1],r=f[2],o=f[3],a=f[4],h=f[5],c=f[6]):(t=f[0],r=f[1],o=f[2],a=f[3],h=f[4]);else if(f.sort(function(t,e){return t-e}),r=l(f,1),o=l(f,2),a=l(f,3),s=a-r,v.get("showOutliers")){for(t=h=i,u=0;u<m;u++)t===i&&f[u]>r-s*v.get("outlierIQR")&&(t=f[u]),f[u]<a+s*v.get("outlierIQR")&&(h=f[u]);n=f[0],c=f[m-1]}else t=f[0],h=f[m-1];this.quartiles=[r,o,a],this.lwhisker=t,this.rwhisker=h,this.loutlier=n,this.routlier=c,d=y/(C-b+1),v.get("showOutliers")&&(w=e.ceil(v.get("spotRadius")),y-=2*e.ceil(v.get("spotRadius")),d=y/(C-b+1),n<t&&g.drawCircle((n-b)*d+w,x/2,v.get("spotRadius"),v.get("outlierLineColor"),v.get("outlierFillColor")).append(),c>h&&g.drawCircle((c-b)*d+w,x/2,v.get("spotRadius"),v.get("outlierLineColor"),v.get("outlierFillColor")).append()),g.drawRect(e.round((r-b)*d+w),e.round(.1*x),e.round((a-r)*d),e.round(.8*x),v.get("boxLineColor"),v.get("boxFillColor")).append(),g.drawLine(e.round((t-b)*d+w),e.round(x/2),e.round((r-b)*d+w),e.round(x/2),v.get("lineColor")).append(),g.drawLine(e.round((t-b)*d+w),e.round(x/4),e.round((t-b)*d+w),e.round(x-x/4),v.get("whiskerColor")).append(),g.drawLine(e.round((h-b)*d+w),e.round(x/2),e.round((a-b)*d+w),e.round(x/2),v.get("lineColor")).append(),g.drawLine(e.round((h-b)*d+w),e.round(x/4),e.round((h-b)*d+w),e.round(x-x/4),v.get("whiskerColor")).append(),g.drawLine(e.round((o-b)*d+w),e.round(.1*x),e.round((o-b)*d+w),e.round(.9*x),v.get("medianColor")).append(),v.get("target")&&(p=e.ceil(v.get("spotRadius")),g.drawLine(e.round((v.get("target")-b)*d+w),e.round(x/2-p),e.round((v.get("target")-b)*d+w),e.round(x/2+p),v.get("targetColor")).append(),g.drawLine(e.round((v.get("target")-b)*d+w-p),e.round(x/2),e.round((v.get("target")-b)*d+w+p),e.round(x/2),v.get("targetColor")).append()),g.render()}}}),D=r({init:function(t,e,i,n){this.target=t,this.id=e,this.type=i,this.args=n},append:function(){return this.target.appendShape(this),this}}),I=r({_pxregex:/(\d+)(px)?\s*$/i,init:function(t,e,i){t&&(this.width=t,this.height=e,this.target=i,this.lastShapeId=null,i[0]&&(i=i[0]),n.data(i,"_jqs_vcanvas",this))},drawLine:function(t,e,i,n,s,r){return this.drawShape([[t,e],[i,n]],s,r)},drawShape:function(t,e,i,n){return this._genShape("Shape",[t,e,i,n])},drawCircle:function(t,e,i,n,s,r){return this._genShape("Circle",[t,e,i,n,s,r])},drawPieSlice:function(t,e,i,n,s,r,o){return this._genShape("PieSlice",[t,e,i,n,s,r,o])},drawRect:function(t,e,i,n,s,r){return this._genShape("Rect",[t,e,i,n,s,r])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(t,e){n(e).html(t)},_calculatePixelDims:function(t,e,i){var s;s=this._pxregex.exec(e),s?this.pixelHeight=s[1]:this.pixelHeight=n(i).height(),s=this._pxregex.exec(t),s?this.pixelWidth=s[1]:this.pixelWidth=n(i).width()},_genShape:function(t,e){var i=L++;return e.unshift(i),new D(this,i,t,e)},appendShape:function(t){alert("appendShape not implemented")},replaceWithShape:function(t,e){alert("replaceWithShape not implemented")},insertAfterShape:function(t,e){alert("insertAfterShape not implemented")},removeShapeId:function(t){alert("removeShapeId not implemented")},getShapeAt:function(t,e,i){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}}),A=r(I,{init:function(e,s,r,o){A._super.init.call(this,e,s,r),this.canvas=t.createElement("canvas"),r[0]&&(r=r[0]),n.data(r,"_jqs_vcanvas",this),n(this.canvas).css({display:"inline-block",width:e,height:s,verticalAlign:"top"}),this._insert(this.canvas,r),this._calculatePixelDims(e,s,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,this.interact=o,this.shapes={},this.shapeseq=[],this.currentTargetShapeId=i,n(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(t,e,n){var s=this.canvas.getContext("2d");return t!==i&&(s.strokeStyle=t),s.lineWidth=n===i?1:n,e!==i&&(s.fillStyle=e),s},reset:function(){var t=this._getContext();t.clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=i},_drawShape:function(t,e,n,s,r){var o,a,l=this._getContext(n,s,r);for(l.beginPath(),l.moveTo(e[0][0]+.5,e[0][1]+.5),o=1,a=e.length;o<a;o++)l.lineTo(e[o][0]+.5,e[o][1]+.5);n!==i&&l.stroke(),s!==i&&l.fill(),this.targetX!==i&&this.targetY!==i&&l.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=t)},_drawCircle:function(t,n,s,r,o,a,l){var h=this._getContext(o,a,l);h.beginPath(),h.arc(n,s,r,0,2*e.PI,!1),this.targetX!==i&&this.targetY!==i&&h.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=t),o!==i&&h.stroke(),a!==i&&h.fill()},_drawPieSlice:function(t,e,n,s,r,o,a,l){var h=this._getContext(a,l);h.beginPath(),h.moveTo(e,n),h.arc(e,n,s,r,o,!1),h.lineTo(e,n),h.closePath(),a!==i&&h.stroke(),l&&h.fill(),this.targetX!==i&&this.targetY!==i&&h.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=t)},_drawRect:function(t,e,i,n,s,r,o){return this._drawShape(t,[[e,i],[e+n,i],[e+n,i+s],[e,i+s],[e,i]],r,o)},appendShape:function(t){return this.shapes[t.id]=t,this.shapeseq.push(t.id),this.lastShapeId=t.id,t.id},replaceWithShape:function(t,e){var i,n=this.shapeseq;for(this.shapes[e.id]=e,i=n.length;i--;)n[i]==t&&(n[i]=e.id);delete this.shapes[t]},replaceWithShapes:function(t,e){var i,n,s,r=this.shapeseq,o={};for(n=t.length;n--;)o[t[n]]=!0;for(n=r.length;n--;)i=r[n],o[i]&&(r.splice(n,1),delete this.shapes[i],s=n);for(n=e.length;n--;)r.splice(s,0,e[n].id),this.shapes[e[n].id]=e[n]},insertAfterShape:function(t,e){var i,n=this.shapeseq;for(i=n.length;i--;)if(n[i]===t)return n.splice(i+1,0,e.id),void(this.shapes[e.id]=e)},removeShapeId:function(t){var e,i=this.shapeseq;
for(e=i.length;e--;)if(i[e]===t){i.splice(e,1);break}delete this.shapes[t]},getShapeAt:function(t,e,i){return this.targetX=e,this.targetY=i,this.render(),this.currentTargetShapeId},render:function(){var t,e,i,n=this.shapeseq,s=this.shapes,r=n.length,o=this._getContext();for(o.clearRect(0,0,this.pixelWidth,this.pixelHeight),i=0;i<r;i++)t=n[i],e=s[t],this["_draw"+e.type].apply(this,e.args);this.interact||(this.shapes={},this.shapeseq=[])}}),O=r(I,{init:function(e,i,s){var r;O._super.init.call(this,e,i,s),s[0]&&(s=s[0]),n.data(s,"_jqs_vcanvas",this),this.canvas=t.createElement("span"),n(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:e,height:i,margin:"0px",padding:"0px",verticalAlign:"top"}),this._insert(this.canvas,s),this._calculatePixelDims(e,i,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,r='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>',this.canvas.insertAdjacentHTML("beforeEnd",r),this.group=n(this.canvas).children()[0],this.rendered=!1,this.prerender=""},_drawShape:function(t,e,n,s,r){var o,a,l,h,c,u,p,d=[];for(p=0,u=e.length;p<u;p++)d[p]=""+e[p][0]+","+e[p][1];return o=d.splice(0,1),r=r===i?1:r,a=n===i?' stroked="false" ':' strokeWeight="'+r+'px" strokeColor="'+n+'" ',l=s===i?' filled="false"':' fillColor="'+s+'" filled="true" ',h=d[0]===d[d.length-1]?"x ":"",c='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+t+'" '+a+l+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+o+" l "+d.join(", ")+" "+h+'e"> </v:shape>'},_drawCircle:function(t,e,n,s,r,o,a){var l,h,c;return e-=s,n-=s,l=r===i?' stroked="false" ':' strokeWeight="'+a+'px" strokeColor="'+r+'" ',h=o===i?' filled="false"':' fillColor="'+o+'" filled="true" ',c='<v:oval  id="jqsshape'+t+'" '+l+h+' style="position:absolute;top:'+n+"px; left:"+e+"px; width:"+2*s+"px; height:"+2*s+'px"></v:oval>'},_drawPieSlice:function(t,n,s,r,o,a,l,h){var c,u,p,d,g,f,m,v;if(o===a)return"";if(a-o===2*e.PI&&(o=0,a=2*e.PI),u=n+e.round(e.cos(o)*r),p=s+e.round(e.sin(o)*r),d=n+e.round(e.cos(a)*r),g=s+e.round(e.sin(a)*r),u===d&&p===g){if(a-o<e.PI)return"";u=d=n+r,p=g=s}return u===d&&p===g&&a-o<e.PI?"":(c=[n-r,s-r,n+r,s+r,u,p,d,g],f=l===i?' stroked="false" ':' strokeWeight="1px" strokeColor="'+l+'" ',m=h===i?' filled="false"':' fillColor="'+h+'" filled="true" ',v='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+t+'" '+f+m+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+n+","+s+" wa "+c.join(", ")+' x e"> </v:shape>')},_drawRect:function(t,e,i,n,s,r,o){return this._drawShape(t,[[e,i],[e,i+s],[e+n,i+s],[e+n,i],[e,i]],r,o)},reset:function(){this.group.innerHTML=""},appendShape:function(t){var e=this["_draw"+t.type].apply(this,t.args);return this.rendered?this.group.insertAdjacentHTML("beforeEnd",e):this.prerender+=e,this.lastShapeId=t.id,t.id},replaceWithShape:function(t,e){var i=n("#jqsshape"+t),s=this["_draw"+e.type].apply(this,e.args);i[0].outerHTML=s},replaceWithShapes:function(t,e){var i,s=n("#jqsshape"+t[0]),r="",o=e.length;for(i=0;i<o;i++)r+=this["_draw"+e[i].type].apply(this,e[i].args);for(s[0].outerHTML=r,i=1;i<t.length;i++)n("#jqsshape"+t[i]).remove()},insertAfterShape:function(t,e){var i=n("#jqsshape"+t),s=this["_draw"+e.type].apply(this,e.args);i[0].insertAdjacentHTML("afterEnd",s)},removeShapeId:function(t){var e=n("#jqsshape"+t);this.group.removeChild(e[0])},getShapeAt:function(t,e,i){var n=t.id.substr(8);return n},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})})}(document,Math),angular.module("akoenig.deckgrid",[]),angular.module("akoenig.deckgrid").directive("deckgrid",["DeckgridDescriptor",function(t){"use strict";return t.create()}]),angular.module("akoenig.deckgrid").factory("DeckgridDescriptor",["Deckgrid","$templateCache",function(t,e){"use strict";function i(){this.restrict="AE",this.template='<div data-ng-repeat="column in columns" class="{{layout.classList}}"><div data-ng-repeat="card in column" data-ng-include="cardTemplate"></div></div>',this.scope={model:"=source"},this.$$deckgrid=null,this.transclude=!0,this.link=this.$$link.bind(this),this.$$templateKeyIndex=0}return i.prototype.$$destroy=function(){this.$$deckgrid.destroy()},i.prototype.$$link=function(i,n,s,r,o){var a="deckgrid/innerHtmlTemplate"+ ++this.$$templateKeyIndex+".html";i.$on("$destroy",this.$$destroy.bind(this)),angular.isUndefined(s.cardtemplate)?(angular.isUndefined(s.cardtemplatestring)?o(i,function(t){var i,n=[],s=0,r=t.length;for(s;s<r;s+=1)i=t[s].outerHTML,angular.isDefined(i)&&n.push(i);e.put(a,n.join())}):e.put(a,n.attr("cardtemplatestring")),i.cardTemplate=a):i.cardTemplate=s.cardtemplate,i.mother=i.$parent,this.$$deckgrid=t.create(i,n[0])},{create:function(){return new i}}}]),angular.module("akoenig.deckgrid").factory("Deckgrid",["$window","$log",function(t,e){"use strict";function i(e,i){var n,s,r=this;this.$$elem=i,this.$$watchers=[],this.$$scope=e,this.$$scope.columns=[],this.$$scope.layout=this.$$getLayout(),this.$$createColumns(),n=this.$$scope.$watchCollection("model",this.$$onModelChange.bind(this)),this.$$watchers.push(n),angular.forEach(r.$$getMediaQueries(),function(t){function e(){t.removeListener(i)}var i=r.$$onMediaQueryChange.bind(r);t.addListener(i),r.$$watchers.push(e)}),s=t.matchMedia("(orientation: portrait)"),s.addListener(r.$$onMediaQueryChange.bind(r))}return i.prototype.$$getMediaQueries=function(){function e(t){try{return t.sheet.cssRules||[]}catch(e){return[]}}function i(t){var e=/\[(\w*-)?deckgrid\]::?before/g,i=0,n="";if(!t.media||angular.isUndefined(t.cssRules))return!1;for(i=t.cssRules.length-1;i>=0;i-=1)if(n=t.cssRules[i].selectorText,angular.isDefined(n)&&n.match(e))return!0;return!1}var n=[],s=[];return n=Array.prototype.concat.call(Array.prototype.slice.call(document.querySelectorAll("style[type='text/css']")),Array.prototype.slice.call(document.querySelectorAll("link[rel='stylesheet']"))),angular.forEach(n,function(n){var r=e(n);angular.forEach(r,function(e){i(e)&&s.push(t.matchMedia(e.media.mediaText))})}),s},i.prototype.$$createColumns=function(){var t=this;return this.$$scope.layout?(this.$$scope.columns=[],void angular.forEach(this.$$scope.model,function(e,i){var n=i%t.$$scope.layout.columns|0;t.$$scope.columns[n]||(t.$$scope.columns[n]=[]),e.$index=i,t.$$scope.columns[n].push(e)})):e.error("angular-deckgrid: No CSS configuration found (see https://github.com/akoenig/angular-deckgrid#the-grid-configuration)")},i.prototype.$$getLayout=function(){var e,i=t.getComputedStyle(this.$$elem,":before").content;return i&&(i=i.replace(/'/g,""),i=i.replace(/"/g,""),i=i.split(" "),2===i.length&&(e={},e.columns=0|i[0],e.classList=i[1].replace(/\./g," ").trim())),e},i.prototype.$$onMediaQueryChange=function(){var t=this,e=this.$$getLayout();e.columns!==this.$$scope.layout.columns&&(t.$$scope.layout=e,t.$$scope.$apply(function(){t.$$createColumns()}))},i.prototype.$$onModelChange=function(t,e){var i=this;t=t||[],e=e||[],angular.equals(e,t)||i.$$createColumns()},i.prototype.destroy=function(){var t=this.$$watchers.length-1;for(t;t>=0;t-=1)this.$$watchers[t]()},{create:function(t,e){return new i(t,e)}}}]),function(t){"use strict";var e={};e.RELAXED=!1,e.IGNORE_RECORD_LENGTH=!1,e.IGNORE_QUOTES=!1,e.LINE_FEED_OK=!0,e.CARRIAGE_RETURN_OK=!0,e.DETECT_TYPES=!0,e.IGNORE_QUOTE_WHITESPACE=!0,e.DEBUG=!1,e.COLUMN_SEPARATOR=",",e.ERROR_EOF="UNEXPECTED_END_OF_FILE",e.ERROR_CHAR="UNEXPECTED_CHARACTER",e.ERROR_EOL="UNEXPECTED_END_OF_RECORD",e.WARN_SPACE="UNEXPECTED_WHITESPACE";var i='"',n="\r",s="\n",r=" ",o="\t",a=0,l=1,h=2,c=4;if(e.parse=function(t){var c=e.result=[];e.offset=0,e.str=t,e.record_begin(),e.debug("parse()",t);for(var u;;){if(u=t[e.offset++],e.debug("c",u),null==u){e.escaped&&e.error(e.ERROR_EOF),e.record&&(e.token_end(),e.record_end()),e.debug("...bail",u,e.state,e.record),e.reset();break}if(null==e.record){if(e.RELAXED&&(u==s||u==n&&t[e.offset+1]==s))continue;e.record_begin()}if(e.state==a){if((u===r||u===o)&&e.next_nonspace()==i){if(e.RELAXED||e.IGNORE_QUOTE_WHITESPACE)continue;e.warn(e.WARN_SPACE)}if(u==i&&!e.IGNORE_QUOTES){e.debug("...escaped start",u),e.escaped=!0,e.state=l;continue}e.state=l}e.state==l&&e.escaped?u==i?t[e.offset]==i?(e.debug("...escaped quote",u),e.token+=i,e.offset++):(e.debug("...escaped end",u),e.escaped=!1,e.state=h):(e.token+=u,e.debug("...escaped add",u,e.token)):u==n?(t[e.offset]==s?e.offset++:e.CARRIAGE_RETURN_OK||e.error(e.ERROR_CHAR),e.token_end(),e.record_end()):u==s?(e.LINE_FEED_OK||e.RELAXED||e.error(e.ERROR_CHAR),e.token_end(),e.record_end()):u==e.COLUMN_SEPARATOR?e.token_end():e.state==l?(e.token+=u,e.debug("...add",u,e.token)):u===r||u===o?e.IGNORE_QUOTE_WHITESPACE||e.error(e.WARN_SPACE):e.RELAXED||e.error(e.ERROR_CHAR)}return c},e.stream=function(){var t=new require("stream").Transform({objectMode:!0});return t.EOL="\n",t.prior="",t.emitter=function(t){return function(i){t.push(e.parse(i+t.EOL))}}(t),t._transform=function(t,e,i){var n=""==this.prior?t.toString().split(this.EOL):(this.prior+t.toString()).split(this.EOL);this.prior=n.pop(),n.forEach(this.emitter),i()},t._flush=function(t){""!=this.prior&&(this.emitter(this.prior),this.prior=""),t()},t},e.stream.json=function(){var t=new require("stream").Transform({objectMode:!0});return t._transform=function(e,i,n){t.push(JSON.stringify(e.toString())+require("os").EOL),n()},t},e.reset=function(){e.state=null,e.token=null,e.escaped=null,e.record=null,e.offset=null,e.result=null,e.str=null},e.next_nonspace=function(){for(var t,i=e.offset;i<e.str.length;)if(t=e.str[i++],t!=r&&t!==o)return t;return null},e.record_begin=function(){e.escaped=!1,e.record=[],e.token_begin(),e.debug("record_begin")},e.record_end=function(){e.state=c,!e.IGNORE_RECORD_LENGTH&&!e.RELAXED&&e.result.length>0&&e.record.length!=e.result[0].length&&e.error(e.ERROR_EOL),e.result.push(e.record),e.debug("record end",e.record),e.record=null},e.resolve_type=function(t){return t.match(/^\d+(\.\d+)?$/)?t=parseFloat(t):t.match(/^(true|false)$/i)?t=Boolean(t.match(/true/i)):"undefined"===t?t=void 0:"null"===t&&(t=null),t},e.token_begin=function(){e.state=a,e.token=""},e.token_end=function(){e.DETECT_TYPES&&(e.token=e.resolve_type(e.token)),e.record.push(e.token),e.debug("token end",e.token),e.token_begin()},e.debug=function(){e.DEBUG&&console.log(arguments)},e.dump=function(t){return[t,"at char",e.offset,":",e.str.substr(e.offset-50,50).replace(/\r/gm,"\\r").replace(/\n/gm,"\\n").replace(/\t/gm,"\\t")].join(" ")},e.error=function(t){var i=e.dump(t);throw e.reset(),i},e.warn=function(t){var i=e.dump(t);try{return void console.warn(i)}catch(n){}try{console.log(i)}catch(n){}},"undefined"!=typeof module&&module.exports)return void(module.exports=e);if("undefined"!=typeof exports)exports.CSV=e;else if("function"==typeof define&&"object"==typeof define.amd)return void define([],function(){return e});t&&(t.CSV=e)}(this),!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){var e,i,n,s=function(t){if(S[t])return S[t].apply(this,Array.prototype.slice.call(arguments,1));if("object"!=typeof t&&t)throw"Method "+t+" does not exist on jQuery.cardswipe";return S.init.apply(this,arguments)},r={generic:function(t){var e=new RegExp("^(%[^%;\\?]+\\?)?(;[0-9\\:<>\\=]+\\?)?([+;][0-9\\:<>\\=]+\\?)?"),i=e.exec(t);if(!i)return null;var n={type:"generic",line1:i[1]?i[1].slice(1,-1):"",line2:i[2]?i[2].slice(1,-1):"",line3:i[3]?i[3].slice(1,-1):""};return n},visa:function(t){var e=new RegExp("^%B(4[0-9]{12,18})\\^([A-Z ]+)/([A-Z ]+)\\^([0-9]{2})([0-9]{2})"),i=e.exec(t);if(!i)return null;var n=i[1];if(!R(n))return null;var s={type:"visa",account:n,lastName:i[2].trim(),firstName:i[3].trim(),expYear:i[4],expMonth:i[5]};return s},mastercard:function(t){var e=new RegExp("^%B(5[1-5][0-9]{14})\\^([A-Z ]+)/([A-Z ]+)\\^([0-9]{2})([0-9]{2})"),i=e.exec(t);if(!i)return null;var n=i[1];if(!R(n))return null;var s={type:"mastercard",account:n,lastName:i[2],firstName:i[3],expYear:i[4],expMonth:i[5]};return s},discover:function(t){var e=new RegExp("^%B(6[0-9]{15})\\^([A-Z ]+)/([A-Z ]+)\\^([0-9]{2})([0-9]{2})"),i=e.exec(t);if(!i)return null;var n=i[1];if(!R(n))return null;var s={type:"discover",account:n,lastName:i[2],firstName:i[3],expYear:i[4],expMonth:i[5]};return s},amex:function(t){var e=new RegExp("^%B(3[4|7][0-9]{13})\\^([A-Z ]+)/([A-Z ]+)\\^([0-9]{2})([0-9]{2})"),i=e.exec(t);if(!i)return null;var n=i[1];if(!R(n))return null;var s={type:"amex",account:n,lastName:i[2],firstName:i[3],expYear:i[4],expMonth:i[5]};return s}},o={IDLE:0,PENDING1:1,PENDING2:2,READING:3,DISCARD:4,PREFIX:5},a={0:"IDLE",1:"PENDING1",2:"PENDING2",3:"READING",4:"DISCARD",5:"PREFIX"},l=o.IDLE,h=function(){if(0===arguments.length)return l;var t=arguments[0];t!=h&&(i.debug&&console.log("%s -> %s",a[l],a[t]),t==o.READING&&n.trigger("scanstart.cardswipe"),l==o.READING&&n.trigger("scanend.cardswipe"),l=t)},c=0,u=function(n){switch(i.debug&&console.log(n.which+": "+String.fromCharCode(n.which)),h()){case o.IDLE:C(n.which)&&(h(o.PREFIX),n.preventDefault(),n.stopPropagation(),d()),37==n.which&&(h(o.PENDING1),e=[],p(n.which),n.preventDefault(),n.stopPropagation(),d()),59==n.which&&(h(o.PENDING2),e=[],p(n.which),n.preventDefault(),n.stopPropagation(),d());break;case o.PENDING1:n.which>=65&&n.which<=90||n.which>=97&&n.which<=122?(h(o.READING),t("input").blur(),p(n.which),n.preventDefault(),n.stopPropagation(),d()):(g(),e=null,h(o.IDLE));break;case o.PENDING2:n.which>=48&&n.which<=57?(h(o.READING),t("input").blur(),p(n.which),n.preventDefault(),n.stopPropagation(),d()):(g(),e=null,h(o.IDLE));break;case o.READING:p(n.which),d(),n.preventDefault(),n.stopPropagation(),13==n.which&&(g(),h(o.IDLE),m()),i.firstLineOnly&&63==n.which&&(h(o.DISCARD),m());break;case o.DISCARD:if(n.preventDefault(),n.stopPropagation(),13==n.which)return g(),void h(o.IDLE);d();break;case o.PREFIX:if(C(n.which))return void h(o.IDLE);n.preventDefault(),n.stopPropagation(),37==n.which&&(h(o.PENDING1),e=[],p(n.which)),59==n.which&&(h(o.PENDING2),e=[],p(n.which)),d()}},p=function(t){e.push(String.fromCharCode(t))},d=function(){clearTimeout(c),c=setTimeout(f,i.interdigitTimeout)},g=function(){clearTimeout(c),c=0},f=function(){i.debug&&console.log("Timeout!"),h()==o.READING&&m(),e=null,h(o.IDLE)},m=function(){i.debug&&console.log(e);var n=e.join("");i.rawDataCallback&&i.rawDataCallback.call(this,n);var s=v(n);s?(i.success&&i.success.call(this,s),t(document).trigger("success.cardswipe",s)):(i.failure&&i.failure.call(this,n),t(document).trigger("failure.cardswipe"))},v=function(e){for(var n=0;n<i.parsers.length;n++){var s,o=i.parsers[n];if(t.isFunction(o)?s=o:"string"==typeof o&&(s=r[o]),null!=s){var a=s.call(this,e);if(null==a)continue;return a}}return null},y=function(){t(document).on("keypress.cardswipe-listener",u)},x=function(){t(document).off(".cardswipe-listener",u)},b=function(t){var e=["Line 1: ",t.line1,"\nLine 2: ",t.line2,"\nLine 3: ",t.line3].join("");alert(e)},C=function(e){return!!i.prefixCodes&&-1!=t.inArray(e,i.prefixCodes)},w={enabled:!0,interdigitTimeout:250,success:b,failure:null,parsers:["generic"],firstLineOnly:!1,prefixCharacter:null,eventSource:document,debug:!1},R=function(t){for(var e=[0,2,4,6,8,1,3,5,7,9],i=0,n=t.length,s=!0;n--;){var r=parseInt(t.charAt(n),10);i+=s?r:e[r],s=!s}return i%10===0&&i>0},S={init:function(s){if(i=t.extend({},w,s),i.prefixCharacter){var r="[object Array]"===Object.prototype.toString.call(i.prefixCharacter);r||(i.prefixCharacter=[i.prefixCharacter]),i.prefixCodes=[],t(i.prefixCharacter).each(function(){if(1!=this.length)throw"prefixCharacter must be a single character";i.prefixCodes.push(this.charCodeAt(0))})}n=t(i.eventSource),g(),h(o.IDLE),e=null,x(),i.enabled&&S.enable()},disable:function(){x()},enable:function(){y()}};s.luhnChecksum=R,s._states=function(){return o},s._stateNames=function(){return a},s._state=function(){return h()},s._settings=function(){return i},s._parseData=function(t){return v(t)},s._builtinParsers=function(){return r},t.cardswipe=s}),angular.module("lvl.directives.dragdrop",["lvl.services"]),angular.module("lvl.directives.dragdrop").directive("lvlDraggable",["$rootScope","uuid",function(t,e){return{restrict:"A",link:function(i,n,s){if("false"!==s.lvlDraggable){angular.element(n).attr("draggable","true");var r=angular.element(n).attr("id");r||(r=e["new"](),angular.element(n).attr("id",r)),n.bind("dragstart",function(e){e.dataTransfer.setData("text",r),e.stopPropagation&&e.stopPropagation(),n.addClass("lvl-dragging"),t.$emit("LVL-DRAG-START")}),n.bind("dragend",function(){n.removeClass("lvl-dragging"),t.$emit("LVL-DRAG-END")}),n.bind("dragover",function(t){return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect="move",!1})}}}}]),angular.module("lvl.directives.dragdrop").directive("lvlDropTarget",["$rootScope","uuid",function(t,e){return{restrict:"A",scope:{onDrop:"&"},link:function(i,n,s){if("false"!==s.lvlDropTarget){var r=angular.element(n).attr("id");r||(r=e["new"](),angular.element(n).attr("id",r)),n.bind("dragover",function(t){return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect="move",!1}),n.bind("dragenter",function(t){angular.element(t.target).addClass("lvl-over")}),n.bind("dragleave",function(t){angular.element(t.target).removeClass("lvl-over")}),n.bind("drop",function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation();var e=t.dataTransfer.getData("text");i.onDrop({dragEl:e,dropEl:r,event:t})});var o=t.$on("LVL-DRAG-START",function(){var t=document.getElementById(r);angular.element(t).addClass("lvl-target")}),a=t.$on("LVL-DRAG-END",function(){var t=document.getElementById(r);angular.element(t).removeClass("lvl-target"),angular.element(t).removeClass("lvl-over")});i.$on("$destroy",function(){o(),a()})}}}}]),angular.module("lvl.services",[]),angular.module("lvl.services").factory("uuid",function(){var t={"new":function(){function t(t){var e=(Math.random().toString(16)+"000000000").substr(2,8);return t?"-"+e.substr(0,4)+"-"+e.substr(4,4):e}return t()+t(!0)+t(!0)+t()},empty:function(){return"00000000-0000-0000-0000-000000000000"}};return t});